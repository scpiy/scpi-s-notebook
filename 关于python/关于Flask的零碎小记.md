# 关于Flask的零碎小记

#### 第五章：用户登录

------

`current_user`什么时候可以使用呢？

答：当你从`flask_login`导入`current_user`之后他就可以使用了。

------



#### 第六章：个人主页与头像

`@app.befor_request`用于定义一个在所有视图函数被调用之前运行的一个小函数，用于执行某种特定个很小的功能。比如更新用户的最后上线时间。

> 考虑在引用`current_user`时，flask-login将调用用户加载函数，该函数会执行一个数据库查询并将目标用户添加到数据库会话中。

也就是说，`db.session.add(user)`在使用`current_user`的时候已经被执行了。

#### 第七章： 错误处理

调试模式可以启用重载器，这样我就不必每次对数据文件进行更改后重启应用了。但对我来说用处似乎不大。

视图函数应该至少拥有两个返回值，第一个是渲染出的html界面，另一个是状态码。默认情况下状态码为200(成功响应)。

回话回滚具体是个什么东西我不清楚，但它的功能大概是让数据库回到上一个"健康"的状态吧。

500错误应该不仅仅会由数据库错误引起，这个回话回滚应该不会误伤"健康"状态下的数据库。也就是说，这个东西应该只是把数据库回到上一次`db.session.commit()`的状态，把从上一次提交之后所有的类似`db.session.add()`或是其他的什么操作删除吧。如果上一次提交之后什么都没有做，那么这个函数应该也是什么都不会做的。

